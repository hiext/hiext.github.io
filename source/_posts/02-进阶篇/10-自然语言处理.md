# 第10章：自然语言处理

## 📝 本章目标
- 掌握文本预处理技术
- 学习词嵌入方法
- 了解命名实体识别
- 实现情感分析系统

## 10.1 文本预处理

```python
import jieba
import re

class TextPreprocessor:
    def __init__(self):
        self.stopwords = set(['的', '了', '在', '是'])
    
    def clean_text(self, text):
        # 去除特殊字符
        text = re.sub(r'[^\w\s]', '', text)
        # 分词
        words = jieba.cut(text)
        # 去除停用词
        words = [w for w in words if w not in self.stopwords]
        return ' '.join(words)

preprocessor = TextPreprocessor()
cleaned = preprocessor.clean_text("这是一个测试文本！")
```

## 10.2 词嵌入

```python
from gensim.models import Word2Vec

class WordEmbedding:
    def __init__(self, sentences):
        self.model = Word2Vec(
            sentences,
            vector_size=100,
            window=5,
            min_count=1,
            workers=4
        )
    
    def get_vector(self, word):
        return self.model.wv[word]
    
    def find_similar(self, word, topn=10):
        return self.model.wv.most_similar(word, topn=topn)

# 使用
sentences = [['我', '爱', 'Python'], ['机器', '学习', '很', '有趣']]
embedding = WordEmbedding(sentences)
```

## 10.3 情感分析

```python
from transformers import pipeline

class SentimentAnalyzer:
    def __init__(self):
        self.classifier = pipeline(
            "sentiment-analysis",
            model="uer/roberta-base-finetuned-chinanews-chinese"
        )
    
    def analyze(self, text):
        result = self.classifier(text)[0]
        return {
            'label': result['label'],
            'score': result['score']
        }

analyzer = SentimentAnalyzer()
result = analyzer.analyze("这个产品非常好用")
```

## 📚 本章小结
- ✅ 文本预处理流程
- ✅ Word2Vec词嵌入
- ✅ 情感分析应用
- ✅ NLP完整pipeline

[⬅️ 上一章](./09-计算机视觉.md) | [返回目录](../README.md) | [下一章 ➡️](../03-实战篇/11-TensorFlow实战.md)
