# 第9章：计算机视觉进阶

## 📝 本章目标
- 掌握目标检测算法
- 学习图像分割技术
- 了解人脸识别系统
- 实现实时物体检测

## 9.1 目标检测

### YOLO实现

```python
from ultralytics import YOLO
import cv2

class ObjectDetector:
    def __init__(self, model_path='yolov8n.pt'):
        self.model = YOLO(model_path)
    
    def detect(self, image_path):
        results = self.model(image_path)
        return results[0].boxes
    
    def detect_realtime(self, video_source=0):
        cap = cv2.VideoCapture(video_source)
        
        while cap.isOpened():
            ret, frame = cap.read()
            if not ret:
                break
            
            results = self.model(frame)
            annotated_frame = results[0].plot()
            
            cv2.imshow('Detection', annotated_frame)
            if cv2.waitKey(1) & 0xFF == ord('q'):
                break
        
        cap.release()
        cv2.destroyAllWindows()

detector = ObjectDetector()
detector.detect_realtime()
```

## 9.2 图像分割

```python
from transformers import SegformerForSemanticSegmentation
import torch

class ImageSegmentation:
    def __init__(self):
        self.model = SegformerForSemanticSegmentation.from_pretrained(
            "nvidia/segformer-b0-finetuned-ade-512-512"
        )
    
    def segment(self, image):
        inputs = self.processor(images=image, return_tensors="pt")
        outputs = self.model(**inputs)
        logits = outputs.logits
        
        # 后处理
        upsampled_logits = nn.functional.interpolate(
            logits,
            size=image.size[::-1],
            mode="bilinear",
            align_corners=False
        )
        
        pred_seg = upsampled_logits.argmax(dim=1)[0]
        return pred_seg
```

## 9.3 人脸识别

```python
import face_recognition

class FaceRecognitionSystem:
    def __init__(self):
        self.known_faces = {}
    
    def register_face(self, name, image_path):
        image = face_recognition.load_image_file(image_path)
        encoding = face_recognition.face_encodings(image)[0]
        self.known_faces[name] = encoding
    
    def recognize(self, image_path):
        image = face_recognition.load_image_file(image_path)
        unknown_encoding = face_recognition.face_encodings(image)[0]
        
        results = []
        for name, known_encoding in self.known_faces.items():
            match = face_recognition.compare_faces([known_encoding], unknown_encoding)
            if match[0]:
                results.append(name)
        
        return results
```

## 📚 本章小结
- ✅ YOLO目标检测
- ✅ 图像分割技术
- ✅ 人脸识别系统
- ✅ 实时检测应用

[⬅️ 上一章](./08-Transformer架构.md) | [返回目录](../README.md) | [下一章 ➡️](./10-自然语言处理.md)
