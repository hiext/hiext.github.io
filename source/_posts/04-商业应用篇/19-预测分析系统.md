# ç¬¬19ç« ï¼šé¢„æµ‹åˆ†æç³»ç»Ÿ

## ğŸ“ æœ¬ç« ç›®æ ‡
- æŒæ¡æ—¶é—´åºåˆ—é¢„æµ‹
- å­¦ä¹ å¼‚å¸¸æ£€æµ‹æŠ€æœ¯
- å®ç°éœ€æ±‚é¢„æµ‹ç³»ç»Ÿ
- å¼€å‘å®Œæ•´é¢„æµ‹åˆ†æå¹³å°

## 19.1 æ—¶é—´åºåˆ—é¢„æµ‹

```python
from statsmodels.tsa.arima.model import ARIMA
import pandas as pd

class TimeSeriesForecaster:
    def __init__(self, order=(1,1,1)):
        self.order = order
        self.model = None
    
    def fit(self, data):
        self.model = ARIMA(data, order=self.order)
        self.fitted = self.model.fit()
        return self
    
    def forecast(self, steps=10):
        return self.fitted.forecast(steps=steps)

# ä½¿ç”¨Prophet
from prophet import Prophet

class ProphetForecaster:
    def __init__(self):
        self.model = Prophet()
    
    def fit(self, df):
        # dféœ€è¦æœ‰'ds'å’Œ'y'åˆ—
        self.model.fit(df)
    
    def predict(self, periods=30):
        future = self.model.make_future_dataframe(periods=periods)
        forecast = self.model.predict(future)
        return forecast
```

## 19.2 å¼‚å¸¸æ£€æµ‹

```python
from sklearn.ensemble import IsolationForest

class AnomalyDetector:
    def __init__(self, contamination=0.1):
        self.model = IsolationForest(contamination=contamination)
    
    def fit_predict(self, X):
        predictions = self.model.fit_predict(X)
        # -1è¡¨ç¤ºå¼‚å¸¸ï¼Œ1è¡¨ç¤ºæ­£å¸¸
        anomalies = X[predictions == -1]
        return anomalies

# LSTMå¼‚å¸¸æ£€æµ‹
class LSTMAnomalyDetector:
    def __init__(self, sequence_length=10):
        self.sequence_length = sequence_length
        self.model = self._build_model()
    
    def _build_model(self):
        from tensorflow import keras
        model = keras.Sequential([
            keras.layers.LSTM(64, input_shape=(self.sequence_length, 1)),
            keras.layers.Dense(1)
        ])
        model.compile(optimizer='adam', loss='mse')
        return model
    
    def detect(self, data, threshold=0.1):
        predictions = self.model.predict(data)
        errors = np.abs(data - predictions)
        anomalies = errors > threshold
        return anomalies
```

## 19.3 é”€å”®é¢„æµ‹ç³»ç»Ÿ

```python
class SalesForecastingSystem:
    def __init__(self):
        self.model = None
        self.scaler = StandardScaler()
    
    def prepare_features(self, df):
        features = pd.DataFrame()
        
        # æ—¶é—´ç‰¹å¾
        features['year'] = df['date'].dt.year
        features['month'] = df['date'].dt.month
        features['day_of_week'] = df['date'].dt.dayofweek
        features['is_weekend'] = df['date'].dt.dayofweek >= 5
        
        # æ»åç‰¹å¾
        features['sales_lag_1'] = df['sales'].shift(1)
        features['sales_lag_7'] = df['sales'].shift(7)
        features['sales_lag_30'] = df['sales'].shift(30)
        
        # æ»šåŠ¨ç»Ÿè®¡
        features['sales_rolling_mean_7'] = df['sales'].rolling(7).mean()
        features['sales_rolling_std_7'] = df['sales'].rolling(7).std()
        
        return features.fillna(0)
    
    def train(self, X, y):
        from xgboost import XGBRegressor
        
        X_scaled = self.scaler.fit_transform(X)
        self.model = XGBRegressor(
            n_estimators=100,
            learning_rate=0.1,
            max_depth=5
        )
        self.model.fit(X_scaled, y)
    
    def predict(self, X):
        X_scaled = self.scaler.transform(X)
        return self.model.predict(X_scaled)
```

## 19.4 åº“å­˜ä¼˜åŒ–

```python
class InventoryOptimizer:
    def __init__(self, holding_cost=1, stockout_cost=10):
        self.holding_cost = holding_cost
        self.stockout_cost = stockout_cost
    
    def calculate_optimal_stock(self, demand_forecast, demand_std):
        """è®¡ç®—æœ€ä¼˜åº“å­˜æ°´å¹³"""
        from scipy.stats import norm
        
        # æœåŠ¡æ°´å¹³
        service_level = 0.95
        z_score = norm.ppf(service_level)
        
        # å®‰å…¨åº“å­˜
        safety_stock = z_score * demand_std
        
        # æœ€ä¼˜è®¢è´§é‡
        optimal_order = demand_forecast + safety_stock
        
        return {
            'optimal_order': optimal_order,
            'safety_stock': safety_stock,
            'reorder_point': demand_forecast + 0.5 * safety_stock
        }
```

## ğŸ“š æœ¬ç« å°ç»“
- âœ… ARIMA/Prophetæ—¶é—´åºåˆ—
- âœ… å¼‚å¸¸æ£€æµ‹ç®—æ³•
- âœ… é”€å”®é¢„æµ‹ç³»ç»Ÿ
- âœ… åº“å­˜ä¼˜åŒ–æ–¹æ¡ˆ

[â¬…ï¸ ä¸Šä¸€ç« ](./18-å›¾åƒè¯†åˆ«åº”ç”¨.md) | [è¿”å›ç›®å½•](../README.md) | [ä¸‹ä¸€ç«  â¡ï¸](./20-å†…å®¹ç”Ÿæˆåº”ç”¨.md)
