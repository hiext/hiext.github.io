# 第20章：AI内容生成应用

## 📝 本章目标
- 掌握文本生成技术
- 学习图像生成模型
- 了解视频生成方法
- 开发内容生成平台

## 20.1 文本生成

```python
from transformers import GPT2LMHeadModel, GPT2Tokenizer

class TextGenerator:
    def __init__(self, model_name='gpt2-chinese'):
        self.tokenizer = GPT2Tokenizer.from_pretrained(model_name)
        self.model = GPT2LMHeadModel.from_pretrained(model_name)
    
    def generate(self, prompt, max_length=100):
        inputs = self.tokenizer.encode(prompt, return_tensors='pt')
        outputs = self.model.generate(
            inputs,
            max_length=max_length,
            num_return_sequences=1,
            no_repeat_ngram_size=2,
            temperature=0.7
        )
        text = self.tokenizer.decode(outputs[0], skip_special_tokens=True)
        return text

generator = TextGenerator()
article = generator.generate("人工智能的未来是")
```

## 20.2 图像生成(Stable Diffusion)

```python
from diffusers import StableDiffusionPipeline
import torch

class ImageGenerator:
    def __init__(self):
        self.pipe = StableDiffusionPipeline.from_pretrained(
            "runwayml/stable-diffusion-v1-5",
            torch_dtype=torch.float16
        )
        self.pipe = self.pipe.to("cuda")
    
    def generate(self, prompt, num_images=1):
        images = self.pipe(
            prompt,
            num_inference_steps=50,
            guidance_scale=7.5,
            num_images_per_prompt=num_images
        ).images
        return images

gen = ImageGenerator()
images = gen.generate("一只可爱的猫咪在花园里玩耍")
```

## 20.3 营销文案生成器

```python
class MarketingCopyGenerator:
    def __init__(self):
        from langchain.llms import OpenAI
        from langchain.prompts import PromptTemplate
        
        self.llm = OpenAI(temperature=0.7)
        
        self.template = PromptTemplate(
            input_variables=["product", "features", "target_audience"],
            template="""
            作为专业的营销文案撰写者，为以下产品撰写吸引人的营销文案：
            
            产品：{product}
            特点：{features}
            目标受众：{target_audience}
            
            请生成：
            1. 产品标题（吸引眼球）
            2. 产品描述（200字左右）
            3. 三个卖点（每个30字以内）
            4. 行动号召语
            """
        )
    
    def generate_copy(self, product, features, target_audience):
        prompt = self.template.format(
            product=product,
            features=features,
            target_audience=target_audience
        )
        return self.llm(prompt)

generator = MarketingCopyGenerator()
copy = generator.generate_copy(
    product="智能手表",
    features="心率监测、GPS定位、50米防水",
    target_audience="25-40岁运动爱好者"
)
```

## 20.4 AI视频生成

```python
class VideoGenerator:
    def __init__(self):
        from moviepy.editor import ImageClip, concatenate_videoclips
        self.ImageClip = ImageClip
        self.concatenate = concatenate_videoclips
    
    def create_video_from_images(self, image_paths, duration=3):
        clips = []
        for img_path in image_paths:
            clip = self.ImageClip(img_path).set_duration(duration)
            clips.append(clip)
        
        video = self.concatenate(clips)
        return video
    
    def add_audio(self, video, audio_path):
        from moviepy.editor import AudioFileClip
        audio = AudioFileClip(audio_path)
        video = video.set_audio(audio)
        return video
```

## 📚 本章小结
- ✅ GPT文本生成
- ✅ Stable Diffusion图像生成
- ✅ 营销文案自动化
- ✅ 视频内容生成

[⬅️ 上一章](./19-预测分析系统.md) | [返回目录](../README.md) | [下一章 ➡️](./21-语音技术应用.md)
